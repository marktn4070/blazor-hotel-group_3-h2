@page "/dashboard/hotel/delete/{hotelId:int}"
@inject Blazor.Services.APIService ApiService
@inject NavigationManager Navigation

<PageTitle>Suite Dreams - Delete Hotel</PageTitle>
<div class="delete_hotel_page">
    <div class="text-center mb-4">
        <h3 class="fw-bold">Dashboard</h3>
    </div>
        <div class="mx-5">
            <div class="row">
                <div class="col-12">
<div class="card shadow-sm mt-4 border-0 shadow-none">
    <div class="card-header bg-transparent border-0">
        <span class="card-title mb-0">
            <h4 class="mb-0">
                <i class="bi bi-person-fill"></i>
                Delete Hotel
            </h4>
        </span>
    </div>
    <div class="card-body">
        @if (hotel == null)
        {
            <p><em>Loading hotel details...</em></p>
        }
        else if (foundHotel == false)
        {
            <div class="alert alert-info">No hotel details found.</div>
        }
        else
        {
            <div class="alert alert-warning">
                <h5>Are you sure you want to delete this hotel?</h5>
                <p><strong>@hotel.Name</strong> - @hotel.City</p>
            </div>

            <button class="btn btn-danger" @onclick="ConfirmDelete">Delete</button>
            <button class="btn btn-secondary" @onclick="Cancel">Cancel</button>
        }
    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public int hotelId { get; set; }
    private HotelDetailsDto? hotel;

    private bool foundHotel = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            hotel = await ApiService.GetHotelByIdAsync(hotelId);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Fejl ved hentning af hotel med id'et {hotelId}: {ex.Message}", hotelId);
            foundHotel = false;
        }
    }

    private async Task ConfirmDelete()
    {
        try
        {
            await ApiService.DeleteHotelAsync(hotelId);
            Navigation.NavigateTo("/dashboard/hotel");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Fejl ved sletning af hotel med id'et {hotelId}: {ex.Message}", hotelId);
        }
        
    }

    private void Cancel()
    {
        Navigation.NavigateTo("/dashboard/hotel");
    }
}
